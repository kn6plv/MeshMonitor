<div class="node">
  <div class="chart-select">
    <select onchange="send('chart.change', { id: '{{id}}', address: event.target.value })">
      {{#each nodes}}
      <option value='{{address}}' {{#if (eq ../selected address)}}selected{{/if}}>{{name}}</option>
      {{/each}}
    </select>
  </div>
  <div class="chart-node">
    {{> ChartNode }}
  </div>
  <div id="scrub_{{id}}" class="chart-scrub" tabindex="0">
    <input type="range" min="0" max="{{maxposition}}" value="{{position}}" step="1">
  </div>
  <script>
    function notify() {
      send('chart.position.change', { id: '{{id}}', position: parseInt(document.querySelector("#scrub_{{id}} input").value) })
    }
    document.querySelector("#scrub_{{id}}").addEventListener('keydown', event => {
      if (event.key == 'ArrowRight') {
        event.target.firstElementChild.stepUp();
        notify();
      }
      else if (event.key === 'ArrowLeft') {
        event.target.firstElementChild.stepDown();
        notify();
      }
    });
    document.querySelector("#scrub_{{id}} input").addEventListener('change', notify);
  </script>
</div>
